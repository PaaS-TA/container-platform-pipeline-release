# PaaS-TA ì»¨í…Œì´ë„ˆ í”Œë«í¼ íŒŒì´í”„ë¼ì¸ ì´ë¯¸ì§€ ë¹Œë“œ

<table>
  <tr>
    <td colspan=2 align=center>í”Œë«í¼</td>
    <td colspan=2 align=center><a href="https://github.com/PaaS-TA/paasta-deployment">ì–´í”Œë¦¬ì¼€ì´ì…˜ í”Œë«í¼</a></td>
    <td colspan=2 align=center><a href="https://github.com/PaaS-TA/paas-ta-container-platform">ì»¨í…Œì´ë„ˆ í”Œë«í¼</a></td>
  </tr>
  <tr>
    <td colspan=2 rowspan=2 align=center>í¬í„¸</td>
    <td colspan=2 align=center><a href="https://github.com/PaaS-TA/portal-deployment">AP í¬í„¸</a></td>
    <td colspan=2 align=center><a href="https://github.com/PaaS-TA/container-platform-portal-release">CP í¬í„¸</a></td>
  </tr>
  <tr align=center>
    <td colspan=4><a href="https://github.com/PaaS-TA/PaaS-TA-Monitoring">ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ</a></td>
  </tr>
  <tr align=center>
    <td rowspan=2 colspan=2><a href="https://github.com/PaaS-TA/monitoring-deployment">ëª¨ë‹ˆí„°ë§</a></td>
    <td><a href="https://github.com/PaaS-TA/PaaS-TA-Monitoring-Release">Monitoring</a></td>
    <td><a href="https://github.com/PaaS-TA/paas-ta-monitoring-logsearch-release">Logsearch</a></td>
    <td><a href="https://github.com/PaaS-TA/paas-ta-monitoring-influxdb-release">InfluxDB</a></td>
    <td><a href="https://github.com/PaaS-TA/paas-ta-monitoring-redis-release">Redis</a></td>
  </tr>
  <tr align=center>
    <td><a href="https://github.com/PaaS-TA/PAAS-TA-PINPOINT-MONITORING-RELEASE">Pinpoint</td>
    <td><a href="https://github.com/PaaS-TA/PAAS-TA-PINPOINT-MONITORING-BUILDPACK">Pinpoint Buildpack</td>
    <td></td>
    <td></td>
  </tr>
  </tr>
  <tr align=center>
    <td rowspan=4 colspan=2><a href="https://github.com/PaaS-TA/service-deployment">AP ì„œë¹„ìŠ¤</a></td>
    <td><a href="https://github.com/PaaS-TA/PAAS-TA-CUBRID-RELEASE">Cubrid</a></td>
    <td><a href="https://github.com/PaaS-TA/PAAS-TA-API-GATEWAY-SERVICE-RELEASE">Gateway</a></td>
    <td><a href="https://github.com/PaaS-TA/PAAS-TA-GLUSTERFS-RELEASE">GlusterFS</a></td>
    <td><a href="https://github.com/PaaS-TA/PAAS-TA-APP-LIFECYCLE-SERVICE-RELEASE">Lifecycle</a></td>
  </tr>
  <tr align=center>
    <td><a href="https://github.com/PaaS-TA/PAAS-TA-LOGGING-SERVICE-RELEASE">Logging</a></td>
    <td><a href="https://github.com/PaaS-TA/PAAS-TA-MONGODB-SHARD-RELEASE">MongoDB</a></td>
    <td><a href="https://github.com/PaaS-TA/PAAS-TA-MYSQL-RELEASE">MySQL</a></td>
    <td><a href="https://github.com/PaaS-TA/PAAS-TA-PINPOINT-RELEASE">Pinpoint APM</a></td>
  </tr>
  <tr align=center>
    <td><a href="https://github.com/PaaS-TA/PAAS-TA-DELIVERY-PIPELINE-RELEASE">Pipeline</a></td>
    <td align=center><a href="https://github.com/PaaS-TA/rabbitmq-release">RabbitMQ</a></td>
    <td><a href="https://github.com/PaaS-TA/PAAS-TA-ON-DEMAND-REDIS-RELEASE">Redis</a></td>
    <td><a href="https://github.com/PaaS-TA/PAAS-TA-SOURCE-CONTROL-RELEASE">Source Control</a></td>
  </tr>
  <tr align=center>
    <td><a href="https://github.com/PaaS-TA/PAAS-TA-WEB-IDE-RELEASE-NEW">WEB-IDE</a></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr align=center>
    <td rowspan=1 colspan=2><a href="https://github.com/PaaS-TA/paas-ta-container-platform-deployment">CP ì„œë¹„ìŠ¤</a></td>
    <td><a href="https://github.com/PaaS-TA/container-platform-pipeline-release">ğŸš© Pipeline</a></td>
    <td><a href="https://github.com/PaaS-TA/container-platform-source-control-release">Source Control</a></td>
    <td></td>
    <td></td>
  </tr>
</table>
<i>ğŸš© You are here.</i>

## ì†Œê°œ
ì»¨í…Œì´ë„ˆ í”Œë«í¼ íŒŒì´í”„ë¼ì¸ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ê³  ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ì—¬ ë ˆíŒŒì§€í† ë¦¬ì— ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ê¸°ìˆ í•˜ì˜€ë‹¤.
### ì‚¬ì „ ì„¤ì¹˜
- JDK ì„¤ì¹˜
- Gradle ì„¤ì¹˜
- Docker ì„¤ì¹˜

<br>

### íŒŒì´í”„ë¼ì¸ ë¹Œë“œ ë°©ë²•
- ì»¨í…Œì´ë„ˆ í”Œë«í¼ íŒŒì´í”„ë¼ì¸ í”„ë¡œì íŠ¸ì˜ jar íŒŒì¼ ìƒì„±ì„ ìœ„í•´ ë¹Œë“œë¥¼ ì§„í–‰í•œë‹¤.
```
$ ./gradlew build -x test
```

<br>

### íŒŒì´í”„ë¼ì¸ ì´ë¯¸ì§€ ìƒì„± ë°©ë²•
- ì»¨í…Œì´ë„ˆ í”Œë«í¼ íŒŒì´í”„ë¼ì¸ í”„ë¡œì íŠ¸ ì´ë¯¸ì§€ ìƒì„±ì— í•„ìš”í•œ íŒŒì¼ì„ ë™ì¼í•œ ë””ë ‰í† ë¦¬ ë‚´ì— ìœ„ì¹˜ ì‹œí‚¨ë‹¤.
- íŒŒì¼ ìœ„ì¹˜ : <br>
  + ì»¨í…Œì´ë„ˆ í”Œë«í¼ íŒŒì´í”„ë¼ì¸
      - [paas-ta-container-platform-pipeline-api](pipeline/paas-ta-container-platform-pipeline-api)
      - [paas-ta-container-platform-pipeline-common-api](pipeline/paas-ta-container-platform-pipeline-common-api)
      - [paas-ta-container-platform-pipeline-ui](pipeline/paas-ta-container-platform-pipeline-ui)
      - [paas-ta-container-platform-pipeline-broker](pipeline/paas-ta-container-platform-pipeline-broker)    
      - [paas-ta-contianer-platform-pipeline-inspection-api](pipeline/paas-ta-container-platform-pipeline-inspection-api)
<br>

> 'paas-ta-container-platform-pipeline-api'ë¥¼ ì˜ˆì‹œë¡œ ì§„í–‰í•œë‹¤.

- íŒŒì¼ ë””ë ‰í† ë¦¬ êµ¬ì„±
```
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ application.yml
â””â”€â”€ paas-ta-container-platform-pipeline-api.jar
```
- Dockerfile í™•ì¸
```
$ cat Dockerfile
```
```
FROM openjdk:8-jdk-alpine
ARG JAR_FILE=build/libs/*.jar
COPY ${JAR_FILE} paas-ta-container-platform-pipeline-api.jar
COPY application.yml /application.yml
ENTRYPOINT ["java","-jar","-Dspring.config.location=application.yml","-Dspring.profiles.active=prod","/paas-ta-container-platform-pipeline-api.jar"]
```
- ì´ë¯¸ì§€ ìƒì„±
  + {K8S_MASTER_NODE_IP} : kubernetes master node clusterì˜ public IP ì…ë ¥
```
$ sudo docker build --tag {K8S_MASTER_NODE_IP}:30002/paas-ta-container-platform-pipeline-repository/paas-ta-container-platform-pipeline-api:latest .
```
- ì´ë¯¸ì§€ ìƒì„± í™•ì¸
```
$ sudo docker images

REPOSITORY                                                            TAG                 IMAGE ID            CREATED             SIZE
xx.xxx.xxx.xx:30002/paas-ta-container-platform-pipeline-repository/container-platform-pipeline-api          latest              45918a869bfd        38 seconds ago      140MB
```

<br>

### íŒŒì´í”„ë¼ì¸ ì´ë¯¸ì§€ Private Repository ì—…ë¡œë“œ ë°©ë²•
> CRI-O container runtime interface, Podman CLIë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì§„í–‰í•œë‹¤.

- CRI-O crio.conf íŒŒì¼ ë‚´ insecure-registries ì„¤ì •ì— Harbor Url ì¶”ê°€ í›„ CRI-Oë¥¼ ì¬ì‹œì‘í•œë‹¤.
```
$ sudo vi /etc/crio/crio.conf
...
insecure_registries = [
 "xx.xxx.xxx.xx:30002"
  ]
...

# cri-o restart
$ sudo systemctl restart crio
```

- registries.conf íŒŒì¼ ë‚´ insecure-registries ì„¤ì •ì— Harbor Url ì¶”ê°€ í›„ podmanë¥¼ ì¬ì‹œì‘í•œë‹¤.
```
$ sudo vi /etc/containers/registries.conf
...    
[[registry]]
insecure = true
location = "xx.xxx.xxx.xx:30002"
...
# podman restart
$ sudo systemctl restart podman
```

- Harbor Repositoryì— ë¡œê·¸ì¸ì„ ì§„í–‰í•œë‹¤.
```
$ sudo podman login {K8S_MASTER_NODE_IP}:30002 --username admin --password Harbor12345
```

- ë¡œê·¸ì¸í•œ Harbor Repositoryì— ì»¨í…Œì´ë„ˆ í”Œë«í¼ íŒŒì´í”„ë¼ì¸ ì´ë¯¸ì§€ë¥¼ Pushí•œë‹¤.
```
$ sudo podman push {K8S_MASTER_NODE_IP}:30002/paas-ta-container-platform-pipeline-repository/paas-ta-container-platform-pipeline-api:latest
```

